---
title: "Time series 2.4 & 2.5 seasonal plots and seasonal subseries plots"
author: "Yuzhou Peng"
date: "2023-09-09"
output: html_document
---

```{r}
library(fpp3)
```

```{r}
data("PBS")
PBS |>
  filter(ATC2 == "A10") |>
  select(Month, Concession, Type, Cost) |>
  summarise(TotalC = sum(Cost)) |>
  mutate(Cost = TotalC/1e6) -> a10 
```

##2.4 Seasonal Plots
A seasonal plot is similar to a time plot except that the data are plotted against the individual “seasons” in which the data were observed. An example is given in Figure 2.4 showing the antidiabetic drug sales.
```{r}
a10 %>%
  gg_season(Cost) + 
  labs(y = "$ million",
       title = "seasonal plot: antidiabetic drug sale")

a10 %>%
  gg_season(Cost, labels = "both") + 
  labs(y = "$ million",
       title = "seasonal plot: antidiabetic drug sale")

a10 %>%
  gg_season(Cost, labels = "left") + 
  labs(y = "$ million",
       title = "seasonal plot: antidiabetic drug sale")
```
A seasonal plot allows the underlying seasonal pattern to be seen more clearly, and is especially useful in identifying years in which the pattern changes.

##multiple seasonal periods

Where the data has more than one seasonal pattern, the **period** argument can be used to select which seasonal plot is required. 
```{r}
data("vic_elec")
vic_elec %>%
  gg_season(Demand, period = "day") +
  labs (y = "MWh", title = "Electricity demand: Victoria")

data("vic_elec")
vic_elec %>%
  gg_season(Demand, period = "day") +
  theme(legend.position = "none")
  labs (y = "MWh", title = "Electricity demand: Victoria")
```

```{r}
vic_elec %>%
  gg_season(Demand, period = "week") + 
  labs(y = "MWh",
       title =  "Electricity demand: Victoria")
```
```{r}
vic_elec %>%
  gg_season(Demand, period = "year") +
  labs(y="MWh", title="Electricity demand: Victoria")
```

##2.5 Seasonal Subseries Plots

An alternative plot that emphasises the seasonal patterns is where the data for each season are collected together in separate mini time plots.
```{r}
a10 %>%
  gg_subseries(Cost) +
  labs(y = "$ million",
       title = "Australian antidiabetic drug sales")

a10 %>%
  gg_season(Cost) +
  labs(y = "$ million",
       title = "Australian antidiabetic drug sales")
```

##Example: Australian holiday tourism

```{r}
data("tourism")
holidays <- tourism %>%
  filter(Purpose == "Holiday") %>%
  group_by(State) %>%
  summarise(Trips = sum(Trips))

autoplot(holidays, Trips) +
  labs(y = "Overnight trips ('000)",
       title = "Australian domestic holidays")

holidays %>%
  gg_season(Trips) +
  labs(y = "Overnight trips ('000)",
       title = "Australian domestic holidays")

holidays %>%
  gg_subseries(Trips) +
  labs(y = "Overnight trips ('000)",
       title = "Australian domestic holidays")
```










